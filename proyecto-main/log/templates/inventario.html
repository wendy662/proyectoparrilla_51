<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Inventario - Parrilla 51</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='estilos.css') }}">
  <style>
    body {
      margin:0;
      font-family:Arial,Helvetica,sans-serif;
      background:#3a3a3a;
      color:#fff;
    }
    .navbar {
      display:flex;
      align-items:center;
      justify-content:space-between;
      background:#2f2f2f;
      padding:10px 20px;
    }
    .navbar .brand {
      display:flex;
      align-items:center;
      gap:10px;
      font-size:22px;
      font-weight:bold;
      color:#ff4444;
    }
    .navbar .brand img {
      width:40px;
      height:auto;
    }
    .navbar .links {
      display:flex;
      gap:20px;
    }
    .navbar .links a {
      color:#fff;
      text-decoration:none;
      font-size:16px;
      transition:color 0.3s;
    }
    .navbar .links a:hover { color:#ffd700; }
    .navbar .perfil-btn {
      background:#ffd700;
      color:#000;
      padding:8px 12px;
      border:none;
      border-radius:4px;
      cursor:pointer;
      font-weight:bold;
    }
    .navbar .perfil-btn:hover { background:#ffcc00; }

    .contenido { padding:40px; }
    h2 { margin-top:40px; color:#ffd700; }
    .btn {
      background:#ffd700;
      color:#000;
      padding:6px 12px;
      text-decoration:none;
      border-radius:4px;
      font-weight:bold;
      margin:5px 0;
      display:inline-block;
    }
    .btn:hover { background:#ffcc00; }
    .btn-edit { background:#00bcd4; color:#fff; }
    .btn-edit:hover { background:#0097a7; }
    .btn-delete { background:#ff4444; color:#fff; }
    .btn-delete:hover { background:#cc0000; }

    .productos-container {
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
      gap:20px;
      margin-top:20px;
    }
    .card {
      background:#2f2f2f;
      padding:15px;
      border-radius:8px;
      text-align:center;
    }
    .img-card {
      width:100%;
      height:150px;
      object-fit:cover;
      border-radius:6px;
    }

    .producto-card {
      display: none;
    }

        /* Estilos para los botones de filtro */
    button {
      background: #6f6f6eda;      
      color: white;             
      padding: 12px 20px;       
      border: none;             
      border-radius: 30px;      
      font-size: 16px;          
      font-weight: bold;        
      cursor: pointer;          
      margin: 5px;              
      transition: all 0.3s ease;
       border: 3px solid #ffd700;
    }

    button:hover {
      background: #e5ddb6;   
      transform: scale(1.05);
       border: 3px solid #ffd700;
    }

    .tabla {
      width:100%;
      border-collapse:collapse;
      margin-top:20px;
      background:#2f2f2f;
    }
    .tabla th, .tabla td {
      border:1px solid #444;
      padding:10px;
      text-align:center;
    }
    .tabla th { background:#444; }

    .badge {
      padding:4px 8px;
      border-radius:4px;
      font-weight:bold;
    }
    .disponible { background:#28a745; color:white; }
    .no-disponible { background:#ff4444; color:white; }

    footer {
      margin-top:40px;
      text-align:center;
      padding:20px;
      background:#2f2f2f;
    }
  </style>
</head>
<body>

  <nav class="navbar">
    <div class="brand">
      <img src="{{ url_for('static', filename='image.png') }}" alt="">
      Parrilla 51
    </div>
    <div class="links">
      {#<a href="{{ url_for('login') }}">Inicio</a>#}
      <a href="{{ url_for('inventario') }}" class="active">Inventario</a>
      <a href="{{ url_for('consultar_reservas') }}">Reservas</a>
                  <a href="#"> Pedidos</a>
                  <a href="#"> Ventas</a>
                  <a href="{{ url_for('inventario') }}">  Productos</a>
                  <a href="{{ url_for('inventario') }}">  Insumos</a>
                  <a href="#"> Reportes</a>
    </div>
    {#<a href="{{ url_for('logout') }}" class="perfil-btn">Salir</a>#}
  </nav>

  <div class="contenido">

    <h2>üì¶ Productos</h2>
    <a href="{{ url_for('agregar_producto') }}" class="btn">+ Agregar Producto</a>
    
    <!-- Botones para filtrar -->
  <div>
    <button onclick="filtrar('cerdo')">Cerdo</button>
    <button onclick="filtrar('res')">Res</button>
    <button onclick="filtrar('pollo')">Pollo</button>
    <button onclick="filtrar('plato del dia')">Plato del dia</button>
    <button onclick="filtrar('acompa√±amiento')">Acompa√±amientos</button>
    <button onclick="filtrar('entradas')">Entradas</button>
    <button onclick="filtrar('platos combinados')">Platos combinados</button>
    <button onclick="filtrar('cortes gruesos')">Cortes gruesos</button>
    <button onclick="filtrar('bebidas')">Bebidas</button>
    <button onclick="filtrar('adicionales')">Adicionales</button>
  </div>




    {% if productos %}
    <div class="productos-container">
    {% for p in productos %}
    <div class="card producto-card" 
        data-categoria="{{ p.get('nombre_categoria', 'sin categor√≠a') | trim | lower }}">
      
      {% if p['imagen'] %}
        {% if p['imagen'].startswith('http') %}
          <img src="{{ p['imagen'] | trim }}" alt="{{ p['nombre'] }}" class="img-card">
        {% else %}
          <img src="{{ url_for('static', filename='uploads/' ~ p['imagen']) }}" alt="{{ p['nombre'] }}" class="img-card">
        {% endif %}
      {% else %}
        <img src="{{ url_for('static', filename='no-image.png') }}" alt="{{ p['nombre'] }}" class="img-card">
      {% endif %}
      
      <h3>{{ p['nombre'] }}</h3>
      <p><strong>Cantidad:</strong> {{ p['cantidad'] }}</p>
      <p><strong>Precio:</strong> COP ${{ "{:,.0f}".format(p['precio']).replace(",", ".") }}</p>
      <p><strong>Categor√≠a:</strong> {{ p.get('nombre_categoria', 'Sin categor√≠a') }}</p>
      <p><strong>Descripci√≥n:</strong> {{ p.get('descripcion', 'Sin descripci√≥n') }}</p>
      <a href="{{ url_for('editar_producto', id_producto=p['id_producto']) }}" class="btn btn-edit">Editar</a>
      <a href="{{ url_for('confirmar_eliminacion', tipo='producto', item_id=p['id_producto']) }}" class="btn btn-delete">Eliminar</a>
    </div>
    {% endfor %}
  </div>

    {% else %}
    <p>No hay productos registrados</p>
    {% endif %}

    <!-- Para el filtro -->
  <script>
  function filtrar(categoria) {
      document.querySelectorAll(".producto-card").forEach(el => {
          if (categoria === "" || el.dataset.categoria === categoria) {
              el.style.display = "block";  
          } else {
              el.style.display = "none";   
          }
      });
  }
  </script>





    <!-- INSUMOS -->
    <h2>ü•ï Insumos</h2>
    <a href="{{ url_for('agregar_insumo') }}" class="btn">+ Agregar Insumo</a>

    <table class="tabla">
      <thead>
        <tr>
          <th>Nombre</th><th>Cantidad</th><th>Precio</th><th>Fecha Vencimiento</th>
          <th>Lote</th><th>Subcategor√≠a</th><th>Acciones</th>
        </tr>
      </thead>
      <tbody>
      {% for i in insumos %}
      <tr>
        <td>{{ i['nombre'] }}</td>
        <td>{{ i['cantidad'] }}</td>
        <td>COP ${{ "{:,.0f}".format(i['precio']).replace(",", ".") }}</td>
        <td>{{ i['fecha_vencimiento'].strftime('%Y-%m-%d') if i['fecha_vencimiento'] else '' }}</td>
        <td>{{ i['lote'].strftime('%Y-%m-%d') if i['lote'] else '' }}</td>
        <td>{{ i.get('nombre_subcategoria', 'Sin subcategor√≠a') }}</td>
        <td>
          <a href="{{ url_for('editar_insumo', id=i['id_insumo']) }}" class="btn btn-edit">Editar</a>
          <a href="{{ url_for('confirmar_eliminacion', tipo='insumo', item_id=i['id_insumo']) }}" class="btn btn-delete">Eliminar</a>
        </td>
      </tr>
      {% else %}
      <tr><td colspan="7">No hay insumos registrados</td></tr>
      {% endfor %}
      </tbody>
    </table>

    <!-- MESAS -->
    <h2>üçΩÔ∏è Mesas</h2>
    <a href="{{ url_for('agregar_mesa') }}" class="btn">+ Agregar Mesa</a>

    <table class="tabla">
      <thead>
        <tr><th>N√∫mero de Mesa</th><th>Capacidad</th><th>Estado</th><th>Acciones</th></tr>
      </thead>
      <tbody>
      {% for m in mesas %}
      <tr>
        <td>{{ m['numero'] }}</td>
        <td>{{ m['capacidad'] }}</td>
        <td>
          {% if m['estado'] == 'Disponible' %}
            <span class="badge disponible">Disponible</span>
          {% else %}
            <span class="badge no-disponible">No disponible</span>
          {% endif %}
        </td>
        <td>
          <a href="{{ url_for('cambiar_estado', id_mesa=m['id_mesa']) }}" class="btn btn-edit">Cambiar Estado</a>
          <a href="{{ url_for('confirmar_eliminacion', tipo='mesa', item_id=m['id_mesa']) }}" class="btn btn-delete">Eliminar</a>
        </td>
      </tr>
      {% else %}
      <tr><td colspan="4">No hay mesas registradas</td></tr>
      {% endfor %}
      </tbody>
    </table>

  </div>

  <footer>
    &copy; 2025 Parrilla 51 - Todos los derechos reservados
  </footer>

</body>
</html>
